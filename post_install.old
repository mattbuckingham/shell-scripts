#!/bin/bash

# check if shell is bash
if [ "$(echo $SHELL)" != "/bin/bash" ];
then
    if command -v chsh >/dev/null 2>&1; then
	chsh -s /bin/bash # change shell to bash
    else
	echo "chsh command not found. Please manually change your shell to bash."
    fi
fi

#unofficial repo to install emacs v28, the version on the official repo is old
#if you skip this you will need to change the config file as some features are missing.
sudo apt-get update > /dev/null
sudo apt-get install software-properties-common -y > /dev/null
sudo add-apt-repository -y ppa:kelleyk/emacs > /dev/dell

# System Update and Upgrade
sudo apt-get update > /dev/null
sudo apt-get install --fix-missing -y > /dev/null
sudo apt-get upgrade --allow-downgrades -y > /dev/null

#install essential apps
sudo apt-get install -y curl git gcc make wget emacs28 python3 pip htop openssh-client rsync netcat > /dev/null

# Check if .bashrc file exists
if [ ! -e ~/.bashrc ]; then
  # Create blank .bashrc file
    touch ~/.bashrc
    echo "#!/bin/bash" >> ~/.bashrc
fi

# add aliases to bashrc file
echo "if [ -f ~/.bash_aliases ]; then" >> ~/.bashrc
echo "  . ~/.bash_aliases" >> ~/.bashrc
echo "fi" >> ~/.bashrc

# download configs from github repo
curl https://raw.githubusercontent.com/bigBadMatt/shell-scripts/master/alias/.bash_aliases -o ~/.bash_aliases > /dev/null

# source bash config
source ~/.bashrc

# download
mkdir -p ~/.emacs.d
curl https://raw.githubusercontent.com/bigBadMatt/shell-scripts/master/emacs/init.el -o ~/.emacs.d/init.el > /dev/null

#Clean up
sudo apt-get install -f > /dev/null
sudo apt-get autoremove -y > /dev/null
sudo apt-get autoclean > /dev/null
sudo apt-get clean > /dev/null
